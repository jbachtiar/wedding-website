<!DOCTYPE html>
<html>
<head>
  <title>Guest Table Search</title>
  <style>
    body {
      font-family: Arial, sans-serif;
    }
  </style>
</head>
<body>
  <h1>Guest Table Search</h1>
  <input type="text" id="searchInput" placeholder="Enter guest name">
  <button onclick="searchTable()">Search</button>
  <div id="result"></div>

  <script>
    function searchTable() {
      var input = document.getElementById("searchInput").value.toUpperCase();
      var resultContainer = document.getElementById("result");
      resultContainer.innerHTML = "";

      fetch('https://docs.google.com/spreadsheets/d/e/2PACX-1vSYSLfzZ_xsJ8EnJ9Yq4T3ee_-5otgKsmbOYpcdqZLH86No797lFQ2g-cN9W35kXEq9ws1iEB0eTsbO/pub?gid=923541529&single=true&output=csv')
        .then(function (response) {
          return response.text();
        })
        .then(function (data) {
          var lines = data.split('\n');
          var matchingGuests = [];

          for (var i = 1; i < lines.length; i++) {
            var row = lines[i].split(',');
            var guestName = row[0].trim().toUpperCase();

            if (guestName.includes(input)) {
              matchingGuests.push({
                name: row[0].trim(),
                tableNumber: row[1].trim()
              });
            }
          }

          if (matchingGuests.length > 0) {
            var table = document.createElement("table");
            var tableHead = document.createElement("tr");
            var nameHeader = document.createElement("th");
            var tableNumberHeader = document.createElement("th");
            nameHeader.appendChild(document.createTextNode("Name"));
            tableNumberHeader.appendChild(document.createTextNode("Table Number"));
            tableHead.appendChild(nameHeader);
            tableHead.appendChild(tableNumberHeader);
            table.appendChild(tableHead);

            matchingGuests.forEach(function (guest) {
              var row = document.createElement("tr");
              var nameCell = document.createElement("td");
              var tableNumberCell = document.createElement("td");
              nameCell.appendChild(document.createTextNode(guest.name));
              tableNumberCell.appendChild(document.createTextNode(guest.tableNumber));
              row.appendChild(nameCell);
              row.appendChild(tableNumberCell);
              table.appendChild(row);
            });

            resultContainer.appendChild(table);
          } else {
            resultContainer.innerHTML = "No matching guests found.";
          }
        })
        .catch(function (error) {
          console.log("Error fetching guest data:", error);
        });
    }
  </script>
</body>
</html>
